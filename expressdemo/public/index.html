<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>动态轨迹demo</title>
    <link rel="stylesheet" type="text/css" href="http://120.77.215.143:6012/arcgis_js_api/library/3.21/3.21/dijit/themes/tundra/tundra.css" />
    <link rel="stylesheet" type="text/css" href="http://120.77.215.143:6012/arcgis_js_api/library/3.21/3.21/esri/css/esri.css" />
    <script type="text/javascript" src="http://120.77.215.143:6012/arcgis_js_api/library/3.21/3.21/init.js"></script>
    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
</head>

<body>
    <div id="map" style="height: 700px;width: 100%;"></div>
    <input type="button" id="openTool" value="开启" />
</body>
<script>
    require(["esri/map", "extLayers/gaodeLayer", "extLayers/TDTLayer",
        "esri/geometry/Polyline", "esri/symbols/SimpleLineSymbol", "esri/tasks/QueryTask", "esri/tasks/query", "esri/graphic", "esri/layers/GraphicsLayer",
        "esri/geometry/Point", "esri/symbols/PictureMarkerSymbol", "esri/SpatialReference", "esri/layers/FeatureLayer"
    ], function (Map, gaodeLayer, TDTLayer, Polyline, SimpleLineSymbol, QueryTask, Query,
        Graphic, GraphicsLayer, Point, PictureMarkerSymbol, SpatialReference, FeatureLayer) {
            var map = new Map("map", {
                center: [112.6, 30.5],
                zoom: 6,
                slider: true,
                nav: false,
                logo: false
            });

            var gaodelayer = new gaodeLayer();
            map.addLayer(gaodelayer);

            var layer = FeatureLayer("http://120.77.215.143:6080/arcgis/rest/services/suzhou/caoqiaozhongxue_after/MapServer/3")
            //map.addLayer(layer);

            var queryTask = new QueryTask("http://120.77.215.143:6080/arcgis/rest/services/suzhou/caoqiaozhongxue_after/MapServer/3");
            var query = new Query();
            query.where = " 1= 1";
            query.outSpatialReference = map.SpatialReference;
            query.returnGeometry = true;
            query.outFields = ["*"];
            queryTask.execute(query, addPointsToMap);
           function addPointsToMap(res){
               console.log(res);
           }

            
                
            
        })
</script>

</html>